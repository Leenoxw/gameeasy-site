---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { gamesData } from '../data/games.js';

// On trie par titre pour un catalogue propre, ou on laisse tel quel
const allGames = [...gamesData];
---

<Layout title="Catalogue des Cracks - GAMEASY">
  <Header />
  
  <main class="catalogue-page">
    <div class="container">
      <header class="cat-header">
        <span class="label">BIBLIOTHÈQUE COMPLÈTE</span>
        <h1>TOUS LES <span class="purple">CRACKS</span></h1>
        <p>Explorez notre collection de {allGames.length} jeux premium vérifiés.</p>
      </header>

      <div class="filter-bar">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Rechercher un jeu..." id="gameSearch" />
        </div>
      </div>

      <div class="game-grid" id="gameGrid">
        {allGames.map(game => (
          <a href={`/gameeasy-site/${game.id}`} class="game-card" data-title={game.title.toLowerCase()}>
            <div class="card-inner">
              <div class="img-badge">{game.cat.split(' / ')[0]}</div>
              <img src={game.image} alt={game.title} class="game-img" />
              <div class="card-content">
                <h3>{game.title}</h3>
                <div class="card-footer">
                  <span class="status">DISPONIBLE</span>
                  <span class="btn-mini">VOIR <i class="fas fa-plus"></i></span>
                </div>
              </div>
            </div>
          </a>
        ))}
      </div>
    </div>
  </main>

  <Footer />
</Layout>

<script>
  // Petit script pour la barre de recherche en temps réel
  const searchInput = document.getElementById('gameSearch');
  const cards = document.querySelectorAll('.game-card');

  searchInput?.addEventListener('input', (e) => {
    const term = (e.target as HTMLInputElement).value.toLowerCase();
    cards.forEach(card => {
      const title = card.getAttribute('data-title');
      if (title?.includes(term)) {
        (card as HTMLElement).style.display = 'block';
      } else {
        (card as HTMLElement).style.display = 'none';
      }
    });
  });
</script>

<style>
  .catalogue-page { padding: 140px 20px 80px; background: #060612; min-height: 100vh; }
  .container { max-width: 1300px; margin: 0 auto; }
  .purple { color: #8a4fff; }

  .cat-header { text-align: center; margin-bottom: 60px; }
  .label { color: #8a4fff; font-weight: 900; letter-spacing: 4px; font-size: 0.8rem; }
  h1 { font-size: 3.5rem; font-weight: 950; margin: 10px 0; color: white; }
  .cat-header p { color: #888; font-size: 1.1rem; }

  .filter-bar { margin-bottom: 40px; display: flex; justify-content: center; }
  .search-box { 
    background: #11111e; border: 1px solid #1e1e2e; 
    padding: 15px 25px; border-radius: 15px; 
    display: flex; align-items: center; gap: 15px; width: 100%; max-width: 500px; 
  }
  .search-box i { color: #8a4fff; }
  .search-box input { 
    background: transparent; border: none; color: white; 
    outline: none; width: 100%; font-size: 1rem; 
  }

  .game-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 25px; }
  
  .game-card { text-decoration: none; color: white; transition: 0.4s; }
  .card-inner { 
    background: #0c0c1d; border-radius: 20px; overflow: hidden; 
    border: 1px solid rgba(255,255,255,0.05); height: 100%; 
    position: relative;
  }
  
  .img-badge { 
    position: absolute; top: 12px; left: 12px; z-index: 2;
    background: rgba(138, 79, 255, 0.9); padding: 4px 10px; 
    border-radius: 6px; font-size: 0.65rem; font-weight: 800;
  }

  .game-img { width: 100%; aspect-ratio: 16/10; object-fit: cover; transition: 0.5s; }
  .card-content { padding: 20px; }
  h3 { font-size: 1.2rem; margin-bottom: 15px; font-weight: 800; }
  
  .card-footer { display: flex; justify-content: space-between; align-items: center; }
  .status { font-size: 0.7rem; color: #00ff88; font-weight: 700; }
  .btn-mini { font-size: 0.75rem; font-weight: 800; color: #8a4fff; }

  .game-card:hover { transform: translateY(-8px); }
  .game-card:hover .card-inner { border-color: #8a4fff; box-shadow: 0 10px 30px rgba(138, 79, 255, 0.15); }
  .game-card:hover .game-img { transform: scale(1.05); }

  @media (max-width: 600px) { h1 { font-size: 2.5rem; } }
</style>